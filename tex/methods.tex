\section{Methods} \label{sec:methods}
The design of the integrated resource model will be informed by existing models in the energy, water and waste sectors. The challenge is to develop a model which can handle resources of mutliple types and qualities whilst remaining computationally tractable.
x approaches to dealing with quality to explore: eqns, food paper, multiple resources etc.

\subsection{Energy models} \label{sec:models_energy}
Introduce the notion of urban energy systems models and their context and purpose before outlining some of their technical characteristics (spatial and temporal resolution, methodology, and the nature of their supply and demand representations) which are of relevence to the models generated here.

\citet{Keirstead2012b} defines an urban energy system (UES) model as \emph{``a formal system that represents the combined processes of acquiring and using energy to satisfy the energy service demands of a given urban area''}\footnote{This definition is derived from a definition of `energy system' given in \citet{Jaccard2005}; a definition of `model' from \citet{Rosen2001}; and a `geographic-plus' definition of `urban' which includes all that contained within an administrative boundary, and traceable upstream flows.}. The authors have extensively reviewed system design models which typically choose combinations of technology sizing and location design and/or operation strategies (decision variables) according to exogenous demand patterns to meet an objective (such as minimum costs or emissions) subject to constraints (for example, equipment operations and mass balances). Models have been made to suit a wide range of needs and contexts, for example the increasing prevelence of \emph{renewable energy sources} (`renewables') requires models such as those of \citet{Cai2009a} which minimises the system cost of renewable energy provision to a community; and \citet{Fleten2005} which considers the optimal investment in renewable sources. These two models themselves make an interesting comparison, because the former aims to minimise system cost whilst the latter is from the perspective of stakeholders making investment decsions---this gives another purpose for models: \emph{econometric}. The interesting aspect to models incorporating renewables is that they must somehow deal with the uncertainty which they bring. The optimal management of \emph{decentralised} resources (which have been shown to bring environmental and economic benefits in Section~\ref{sec:urbanOpps} are considered in models such as \citet{Ren2010} which develops optimimal technology combination and operation strategies for a university campus, confirming the carbon-savings possible with distributed systems. The specific needs of \emph{rural communities} in \emph{developing countries} can also be examined in models, such as that of \citet{Kumaravel2012} who optimise an energy supply system (making use of renewables) in order to electrify a village in India. A further subset of system design models would be those that concern the retrofit of existing systems such as that of \citet{Bojic2010} which optimises the refurbishment of pipelines and pumps for a district heating system.

Therefore, there exists a diverse range of technology models to suit a wide-variety of situations. Each of these models will have different technical attributes associated with them. \citet{Kierstead2012b} lists the following attributes to classify an UES model: spatial resolution, temporal resolution resolution (which also corresponds to its time horizon), the solution method and the nature of the supply and demand representation (endogenous or exogenous). The number of resource types considered, and their quality could be added to this list. In terms of \emph{spatial} attributes, system design models are defined over a district ranging from a few buildings \citep{Bojic2010} through to the optimisation of an energy system for whole `eco-towns' \citep{Keirstead2012}. \emph{Temporal resolution} will either be static in the case of design problems, for example \citet{Sugihara2004} which is designing an integrated energy system for business and residential areas. A long-term design can be called `dynamic' if it multiple periods where investment/design decisions are to be made, as for \citet{Siriputtisak2009} which makes investment decisions for every year over fourteen years. Finally, models concerned with the optimal operation of UESs will tend to have a sub-daily resolution such as \citet{Ooka2009} which optimises the equipment output at every hour in a day. Concerning the \emph{methods} employed to solve UES optimisation problems, the literature is dominated by mixed-integer linear programming (MILP). This may require the linearisation of functions where decision variables are multiplied together as performed in \citet{Siriputtisak2009}. Only a few models employ non-linear methods (for example, genetic algorithms) such as \citet{Ooka2009}, which models technologies more realistically at the expense of increased computational time. An interesting example of a UES model. Other techniques included two-stage and fuzzy-stochastic programming (which deal with uncertainty), for example in the case of \citet{Cai2009a} which represents uncertain energy supplies with probabalistic distributions and interval values to maximise UES reliability. Finally, multi-objective methods can be applied in various ways to all the afformentioned methods. There are various ways in which an objective can incorporate multiple concerns (for example cost, emissions and reliability). One method is to sum all such values in an objective function with user-defined weightings (REFERENCE). Another is to perform an optimisation where objective function values (for example primary energy consumption and cost) are plotted against each other to see the trade-off between objectives \citep{Sugihara2004}.

\subsubsection{Example: Optimisation based design of a district energy system for an eco-town in the United Kingdom \citep{Weber2011}}
An interesting model to briefly describe is that of \citet{Weber2011} because it incorporates several of the purpose and technical features described here to ensure a reliable supply of energy for an eco-town which meets emissions targets.
\begin{itemize}
	\item \emph{Renewable} energy sources and their stochastic nature are considered. Wind (summer dominant) and PV (winter dominant) can be combined with non-renewables.
	\item \emph{Centralised} and \emph{Decentralised} systems are combined. The former includes wind turbines, large scale cooling and a CHP plant; the latter considers PV cells, solar thermal  collectors, small heat pumps and boilers.
	\item \emph{Multiple objectives} are considered. The objective is to minimise total cost:  $\min\{\sum cost\}$. Sensetivity analysis is used to impose emissions varying limits, thus both the minimisation of costs and the achievement of emissions targets are objectives of the model through Pareto optimisation.
	\item \emph{MILP} is the method used. The model is built using GAMS and solved with the Cplex solver.
	\item \emph{Design} and \emph{operation} of the system are both solved. Thus decision variables include: technology choice, size and location; operating stategies; and network layout.
	\item \emph{Linerisation} non-linear technology size-cost relationships is emplyed using piecewise linearlisation.
	\item \emph{Uncertainty} in wind conditions is tested by sensitivity analysis\footnote{For this reason, this isn't stochastic modelling. Nevertheless it is a way of considering a model with uncertain inputs.}. Sensitivity analysis is also used to measure the effects of markets and changes in heating demand.
\end{itemize}
The model outputs an energy supply configuration which meets heating, hot water and electricity demands for sub-daily periods at minimal cost.

\subsubsection{Further technical model considerations}
Other model technicalities (not explicitly identified in \citet{Keirstead2012b}) include the incorporation of multiple resource types (for example energy and water); and resource quality consideriations---both of which are necessary for the development of the integrated resource model. The closest that the literature comes to integrated resource models concerning energy is that of \citet{Lu2009} which is a multi-period waste management model which incorporates waste-to-energy (WtE) as a waste management system, thus requiring an objective function in which WtE can generate revenue and minimise waste going to landfill; as well as decision variables which determine investment and capacity decisions for WtE plants. To consider resource quality in a model, the food production model of \citet{Mehdizadeh} can be considered. This will enable a model to meet the challenges of requiring processes to use materials of different qualities (as well as quantities). \citet{Mehdizadeh2011} optimises the energy requirements and quality of product in food processing. A quality model describes food quality as a function of various time dependent and independent characterstics (such as moisture and colour). An energy model calulates the power used in food processing. These models are integrated into the food production model as constraints (alongside capacity limits, mass balances and so on) in order to minimise process cost, wastage and energy, and maximise quality, using MILP. The quality model will model how processes change the quality of a material, and how blending materials of different qualities will combine to form a final product of given quality. Thus the quality of a resource can be known at any point in its processing. To achieve a certain quality product, a given amount of energy will have to be put in at various processing stages.

Finally, \citet{Samsatli} has pointed out that exising UES optimisation models tends to focus on \emph{`single technologies or system configurations'} and there is a need for a more generic, flexible approach. More generic models in the literature tend to have short-comings, such as lacking spatial dependence\footnote{\citet{Ren2010}.} or being too detailed for use at the city scale\footnote{\citet{Weber2011}.}. Thus the authors develop a model with the aim of being generic, exptensible, temporally and spatially disaggregated and considerate of storage. The short comings are that non-linearity is not considered and energy flows can't be espressed as temperature or mass flow rate. MILP is used to obtain a cost optimal solution to meet heat and electricity demand in a city, which is divided into zones of a given dynamic resource demand and given technologies, transport connections and external connections. The resource demand is given by the interconversion of resources, within-city or external transport or storage. A State-Task-Network (STN) formulation is used to represent resources (as states) and the processes which convert resources from an input state to an output state as tasks. The main constraint is a mass balance for each resource (imported, exported, consumed and produced) within each zone. Clearly such a generic forumulation might be useful in an integrated resource model which needs to consider multiple resource and process types, and how processes can interconvert resources.
% diagram.
% method challenge of energy flows (not heat etc.)
% check up on the way it considers material quality.
% intro: write about movement of models from specific to generic (to justify structure of section in aesthetic way!)

In summary then, UES models are varied according the situation that they are used for. Models can be categorised according to various technical characteristics. The literature lack much in the way of energy models that are integrated (for optimisation purposes) with other resources. There is also a lack of models which consider material qualities as something to be optimised along with energy requrements. There does exist a model which can use the generic starting point required for an integrated resource model.
% Broadest of the three resources. 
Having outlined specific features, the model of as;dlfkjas;lj is now described which is meant to be a generic\ldots

\subsection{Water models}
As with energy systems, water network optimisation can be applied to various scales, resolutions, purposes and audiences. Water models can be sub-divided int three levels\footnote{Note that this characterisation of network levels isn't a definition from the literature, but one formulated here.}. At the lowest level, models are concerned with the precise location and dimensions of pipes in a network, such that demand is met reliably at minimum cost. Examples of these models include \citet{Keedwell2005} in which pipe dimensions are the decision variables; hydraulic equations (for mass and energy conservations) and required flow rates and heads form the constraints; and the objective is to minimise total head deficit and cost\footnote{This is another method of multi-objective optimisation, whereby two different objectives are summed and weighted in an objective function.}. 

At the `medium' level of water network design (WND), the decision variables include reservoir heights and pump sizes (as well as pipe dimensions)---for example, the model of \citet{Zangenah2010}. The authors apply the model to the water network of a city, choosing initial values for pipe sizes, reservoir heights and pump characteristics. An iterative procedure is followed where the optimal DV values hydraulic analysis is compared with the assumed values until convergence.

Note that these low and medium level models can be applied to both existing network layouts (as for the previous two examples), and the case where a layout is to be determined, as for \citet{Lejano2006} where the geographical layout is also part of the optimisation, given the spatial distribution and demands of the customers. Thus all possible pipe locations are inputs to the problem and a Boolean DV specifies the presence of a pipe. 

Discussion of methods here?

At the high level, we see how water systems integration (which dominated the discussion in Section~\ref{sec:urbanOpps} can be modelled---thus it is these that are of primary interest at this stage. This kind of model is often found in the chemical engineering literature (for example, \citet{Khor2012}). In an urban context, \citet{Lim2010} has proposed an optimisation tool for an integrated water system, which aims to minimise imports (thus `closing the loop'), by providing water of appropriate qualities to various users, and reducing the need to pass all water through the highest standards of treatment. The `superstructure' is defined conceptually (in a similar way to the generic resource model of \citet{Samsatli} described in Section~\ref{sec:models_energy}), and includes all the water resources (rivers, wells and so on), demand systems and treatment plants. All possible connections between sources and sinks are defined. Constraints include mass balances, and allowable connections (to forbid the connection of a wastewater plant outlet to a drinking water system); and the quality of water for various uses. The optimisation takes place in two steps, whereby contaminants are first minimised, followed by imports. The model proves successful in a case study of water supply systems in a city of more than one million residents with the result that human health and water security both improve (validated by the real-world application of the model).

Other high level models exist for urban water management. For example, the model of \citet{Makropoulos2008} decides on the optimal combination of water saving technologies and strategies which categorises water as potable, grey, green wastewater and runoff, such that for some purposes (for example, toilet flushing), potable water can be reaplec by grey and green water. The model integrates systems at multiple scales: household, decentralised and centralised technologies and uses. Starting at the household level water flows and quality are simulated in four subsystems (sources, allocation, use and switches) each with their own preference for water quality. Households are aggregated into a composite block, where they can be integrated with decentralised systems (such as rainfall harvesting), before integrating the composite blocks together with centralised systems. However, the authors don't provide detail concerning the equations which the model is based on.

Models do exist that overlap both the superstructure approach and the lower-level network design approach. For example \citet{Chung2008} optimise network component DVs (pipes and pumps) in a system with multiple water resources and multiple users who require water of different qualities for their purposes.

In water system design, the objective fuctions and constraints are frequently non-linear, thus the literature is dominated by non-linear programming techniques such as genetic algorithms. There are a few cases of MILP being used with linearised forms of problems (for example \citet{Zanganeh2010} and \citet{Lejano2006}) to achieve quicker computation times. These models can have a multiple-period design focus where investements are to be made over a longer period of time, meeting changing demands \citep{Chung2008}.

%Note non-linearity---many variations on the non-linear programme.
%Heuristics (Lejano).
%Examples where linearisation takes place. 
%iterative procedures.
%OFs in problems: e.g. for the case when reclaimed water is the focus---savings from marginal cost of water supply.
%Long term design.
%design and strategy.
Summary---use of solution techniques from the low and medium level problems.

\subsection{Waste models}
%Accounting and optimisation.
Finally, waste management models are considered. Broadly, these aim to allocate multiple waste streams from multiple origins to multiple destinations over multiple periods at minimum cost. 
A review of waste management models by \citet{Morrissey2004} shows the discipline has moved on from considering simply the minimisation of financial cost, to focus on integrated waste management which considers the benefits of recycling and energy generation. It is obviously the latter class of models which should be considered in this study, requiring multi-objective techniques.

These tend to be long-term and stochastic due to uncertainties in waste generation rates.

A simple model, such as that of \citet{Bovea2006} can be used to assess the environmental impact of various waste management strategies (which each have their own diversion rates of waste streams to landfill, recycling, composting, energy generation and so on). Thus each of the possible destinations must each have their own model which spcifies emissions and energy consumption and so on. Thus combining all the life-cycle assessment (LCA) results from all the waste management options will give an environmental impact assessment which can be compared between the strategies. Running the simulations confirm the environmental benefits which can be achieved from recycling and composting. A similar approach is taken by \citep{Eriksson2002} which combines sub-models for incineraion, digestion and other processes to use LCA to compare waste management plans. Finally, a model is discussed here which overlaps with energy management. \citet{Geng2010} proposes a model which uses geographic proximities to make use of synergies and directly transfer municipal solid waste (MSW) to industrial applications and WtE generation. The emissions and costs associated with various processes within the waste-energy nexus (including transport, facilty construction and carbon savings from landfill diversion) are calculated in various scenarios for comparison. Three stages are required in this model:
\begin{enumerate}
	\item Develop technology database of lifecycle environmental costs.
	\item Develop spatial database of waste generation, facilities and transport distances.
	\item Investigate different scenarios of waste allocation, for comparison.
\end{enumerate}.
	
	% should the above go in the Opportunities section?
		

However, optimisation (rather than simulation) is the concern of this project. The optimisation models in waste management tend to be multi-period (due to capacity expansion requirements over the long-term---especially for landfill); and stochastic (due to the uncertainty of waste generation rates). The objective in the \emph{short term} is to find the allocation (for example in tons/week) of waste flow to various facilities; and capacity expansion requirements (and other strategic planning decisions) in the \emph{long-term}. For example, \citet{Guo2009} considers the long term problem of waste management in a situation where there are uncertainties in system parameters and their interactions. in order to determine optimal capacity expansions and flow allocations at minimum cost. Fines are incurred for exceeding the capacity of a system. A method known as the `inexact fuzzy chance-constrained two-stage mixed integer program. In these problems, some constraints exhibit two typeds of uncertainties. Firslty, those that are given by a probability distribution (such as waste generation rates and transport costs); secondly, those given by intervals. Therefore, flow allocations and investment decisions have to take place before the value of the random variable is made known. The second stage of the problem is to make another decision which minimises penalties incurred in view of the probabilistic excess waste flows. The objective is to minimise costs, subject to constraints on capacity, mass balances and facility expansions. Similar models are proposed by \citet{Li2006}, \citet{He2009} and \citet{Xi2010}. 

A variation of the model is proposed by \citet{Cheng2003} which chooses the optimal location for a landfill site. The challenge is that costs are dependent on waste flows, which themselves are dependent on the site; and the site choice itself is depedent on cost. 
\begin{enumerate}
	\item In a first stage, the model estimates the costs of developing particular sites, subject to capacity and mass balance constraints. `Inexact mixed integer linear programming' (IMILP) is used to handle uncertain parameter values.
	\item The site costs are then used as inputs into a multi-criteria decision analysis (MCDA) (of which there are various methods), along with impacts such as groundwater contamination and public acceptence. The optimal solution is then found, along with waste allocation rates.
\end{enumerate}


In summary then, it can be said that waste management models are dominated by concerns about uncertainty.
% integration with energy models.

\subsection{Conclusion}
The literature review reveals that there is nothing in the way of an integrated resource model and very little which considers resource quality---both of which are required in model.

The superstructure approach (from chemical engineering) and the generic, flexible approach of \citet{Samsatli} both show promise for the development of an initial resource integration model. Complexities such as uncertainties, 

Variation between solution methods between the various disciplines needs to be managed.
